<link rel="stylesheet" href="~/css/privacy-customization.css" asp-append-version="true"/>

@{
    ViewData["Title"] = "Условия за ползване";
}
<div class="container-fluid mt-3 privacy-container">
    <ul class="breadcrumb">
        <li><a href="@Url.Action("Index", "Home")">Начало</a></li>
        <span><i class="bi bi-chevron-right"></i></span>
        <li><a href="@Url.Action("Privacy", "Home")">Общи условия</a></li>
    </ul>
    <div class="privacy-body">
        <div class="list-quick-links">
            <h2 class="section-title">Важни теми</h2>
            <ul>
                <li><a href="#" data-partial="PrivacyPartials/_TermsAndConditionsPartial">Общи условия</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_InquiryPartial" data-target="generalInquiry">Запитване от общо естество</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_InquiryPartial" data-target="productInquiry">Запитване за продукт</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_ConsultationPartial">Консултация</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderAndPaymentPartial" data-target="q1">Процедура по извършване на поръчка</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderAndPaymentPartial" data-target="q3">Методи за плащания при онлайн поръчки</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderAndPaymentPartial" data-target="q7">Опция „Вземи от магазин“ – условия и начин на плащане</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderAndPaymentPartial" data-target="q8">Издаване и корекция на фактури</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_ShippingCourierPartial" data-target="q3">Куриерски услуги</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_ShippingCourierPartial" data-target="q5">Статус на поръчка</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_ShippingCourierPartial" data-target="q6">Проследяване на пратка</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderCancellationPartial" data-target="q3">Упражняване право на отказ от поръчка</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_OrderCancellationPartial" data-target="q4">Процедура за възстановяване на плащания при отказ от договора</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_WarrantyAndClaimsPartial" data-target="q1">Замяна на закупена стока</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_WarrantyAndClaimsPartial" data-target="q3">Процедура за подаване на рекламация</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_WarrantyAndClaimsPartial" data-target="q5">Гаранционна карта</a></li>
                <li><a href="#" data-partial="PrivacyPartials/_PrivacyPolicyPartial">Политика на личните данни</a></li>
            </ul>
        </div>
        <div class="content-table-wrapper">
            <h2 class="section-title">Всички условия и политики</h2>
            <ul class="cards-wrapper">
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_TermsAndConditionsPartial">
                        <div class="icon-container">
                            <i class="bi bi-file-earmark-text"></i>
                        </div>
                        <p>Общи условия</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_InquiryPartial">
                        <div class="icon-container">
                            <i class="bi bi-question-circle"></i>
                        </div>
                        <p>Запитвания</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_ConsultationPartial">
                        <div class="icon-container">
                            <i class="bi bi-chat-dots"></i>
                        </div>
                        <p>Консултация</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_OrderAndPaymentPartial">
                        <div class="icon-container">
                            <i class="bi bi-credit-card"></i>
                        </div>
                        <p>Поръчки и плащания</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_ShippingCourierPartial">
                        <div class="icon-container">
                            <i class="bi bi-truck"></i>
                        </div>
                        <p>Доставка с куриер</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_OrderCancellationPartial">
                        <div class="icon-container">
                            <i class="bi bi-x-circle"></i>
                        </div>
                        <p>Отказ от поръчка</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_WarrantyAndClaimsPartial">
                        <div class="icon-container">
                            <i class="bi bi-shield-check"></i>
                        </div>
                        <p>Гаранция и рекламация</p>
                    </a></li>
                <li><a class="content-card" href="#" data-partial="PrivacyPartials/_PrivacyPolicyPartial">
                        <div class="icon-container">
                            <i class="bi bi-lock"></i>
                        </div>
                        <p>Политика на личните данни</p>
                    </a></li>
            </ul>
            <div id="partial-container">
                <!-- Loaded partial will appear here -->
            </div>

        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll('[data-partial]').forEach(el => {
                el.addEventListener("click", function (e) {
                    e.preventDefault();
                    loadPartialFromElement(this);
                });
            });
        });

        async function loadPartialFromElement(element) {
            const partialName = element.getAttribute("data-partial");
            const targetSelector = element.getAttribute("data-target"); // e.g., "#q1"

            if (!partialName) return;

            try {
                const response = await fetch(`/Home/LoadPartial?partialName=${encodeURIComponent(partialName)}`);
                const html = await response.text();
                const partialContainer = document.getElementById("partial-container");
                partialContainer.innerHTML = html;

                // Smooth scroll into view
                partialContainer.scrollIntoView({behavior: "smooth", block: "start"});

                // Optional: wait for a moment to ensure DOM is updated
                setTimeout(() => {
                    if(targetSelector === 'productInquiry') {
                        document.getElementById('generalInquiry-tab').classList.remove('active');
                        document.getElementById('generalInquiry').classList.remove('show');
                        document.getElementById('generalInquiry').classList.remove('active');
                        document.getElementById('productInquiry-tab').classList.add('active');
                        document.getElementById('productInquiry').classList.add('show');
                        document.getElementById('productInquiry').classList.add('active');
                    }
                    else if (targetSelector) {
                        const collapseEl = partialContainer.querySelector(targetSelector);
                        if (collapseEl && typeof bootstrap !== "undefined") {
                            const bsCollapse = new bootstrap.Collapse(collapseEl, {toggle: false});
                            bsCollapse.show();
                        } else if (collapseEl) {
                            // Fallback for non-Bootstrap collapse (just add show class)
                            collapseEl.classList.add("show");
                        }
                    }
                }, 100); // slight delay to ensure content is fully injected
            } catch (error) {
                console.error("Error loading partial:", error);
            }
        }
    </script>
    <script>
        async function loadPartial() {
            const partialName = "PrivacyPartials/_InquiryPartial";
            try {
                const response = await fetch(`/Home/LoadPartial?partialName=${encodeURIComponent(partialName)}`);
                if (!response.ok) throw new Error("Failed to load partial: " + response.statusText);

                const html = await response.text();
                const partialContainer = document.getElementById("partial-container");

                if (partialContainer) {
                    partialContainer.innerHTML = html;
                    partialContainer.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});
                }
            } catch (error) {
                console.error("Error loading partial:", error);
            }
        }

    </script>
}

